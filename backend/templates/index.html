<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fashionary API Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">AI Agent Bake-off Backend API</h1>
            <p class="text-gray-600">API for managing e-commerce products and users</p>
        </header>

        <!-- API Documentation Links -->
        <section class="my-8 bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">API Documentation & Agent Developer Kit (ADK) Docs</h2>
            <div class="space-y-4">
                <a href="https://google.github.io/adk-docs/get-started/about/" class="block p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                    <h3 class="font-medium text-blue-700">Agent Developer Kit (ADK)</h3>
                    <p class="text-sm text-blue-600">ADK is designed to empower developers to build, manage, evaluate and deploy AI-powered agents.</p>
                </a>
                <a href="https://google.github.io/adk-docs/agents/workflow-agents/" class="block p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                    <h3 class="font-medium text-blue-700">Workflow Agents (Sequential, Parallel, and Loop agents)</h3>
                    <p class="text-sm text-blue-600">Workflow agents are a type of agent that can be used to build complex workflows.</p>
                </a>
                <a href="/docs" class="block p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                    <h3 class="font-medium text-blue-700">Swagger UI Documentation</h3>
                    <p class="text-sm text-blue-600">Interactive API documentation with Swagger UI</p>
                </a>
                <a href="/redoc" class="block p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                    <h3 class="font-medium text-blue-700">ReDoc Documentation</h3>
                    <p class="text-sm text-blue-600">Alternative API documentation with ReDoc</p>
                </a>
            </div>
        </section>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Products Section -->
            <section class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">Product Endpoints</h2>
                <div class="space-y-4">
                    <div class="border-l-4 border-blue-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /products</h3>
                        <p class="text-sm text-gray-600">Get all products with optional sorting</p>
                    </div>
                    <div class="border-l-4 border-blue-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /products/sort/stockouts</h3>
                        <p class="text-sm text-gray-600">Get products sorted by stock level</p>
                    </div>
                    <div class="border-l-4 border-blue-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /products/{product_id}</h3>
                        <p class="text-sm text-gray-600">Get specific product details</p>
                    </div>
                    <div class="border-l-4 border-blue-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /products/{product_id}/display</h3>
                        <p class="text-sm text-gray-600">Get product with formatted display data</p>
                    </div>
                    <div class="border-l-4 border-blue-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /metadata/products</h3>
                        <p class="text-sm text-gray-600">Get product metadata and statistics</p>
                    </div>
                </div>
            </section>

            <!-- Users Section -->
            <section class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4">User Endpoints</h2>
                <div class="space-y-4">
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /users</h3>
                        <p class="text-sm text-gray-600">Get all users</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /users/{user_id}</h3>
                        <p class="text-sm text-gray-600">Get specific user details</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /users/{user_id}/purchases</h3>
                        <p class="text-sm text-gray-600">Get user's purchase history</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /users/{user_id}/cart</h3>
                        <p class="text-sm text-gray-600">Get user's current cart</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /users/{user_id}/style-preferences</h3>
                        <p class="text-sm text-gray-600">Get user's style preferences</p>
                    </div>
                    <div class="border-l-4 border-green-500 pl-4">
                        <h3 class="font-medium text-gray-700">GET /metadata/users</h3>
                        <p class="text-sm text-gray-600">Get user metadata and statistics</p>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- Example uses of the API that shows code snippets -->
        <section class="mt-8 bg-white rounded-lg shadow-md p-6">  
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">Example Uses of the API</h2>          
            <!-- Product Display Example -->
            <div class="mb-8">
                <h3 class="text-lg font-medium text-gray-700 mb-2">JAVASCRIPT: Product Display Example</h3>
                <pre class="max-h-[30rem] overflow-y-auto"><code class="language-javascript" id="product_example"></code></pre>
            </div>

            <!-- User Display Example -->
            <div class="mb-8">
                <h3 class="text-lg font-medium text-gray-700 mb-2">JAVASCRIPT: User Display Example</h3>
                <pre class="max-h-[30rem] overflow-y-auto"><code class="language-javascript" id="user_example"></code></pre>
            </div>

            <div class="mb-8">
                <h3 class="text-lg font-medium text-gray-700 mb-2">PYTHON: Example of User and Products</h3>
                <pre class="max-h-[30rem] overflow-y-auto"><code class="language-python" id="python_example">
                    
import requests

def get_total_users():
    """
    Get the total count of users from the backend API
    Returns:
        int: Total number of users
    """
    try:
        response = requests.get('https://backend-879168005744.us-west1.run.app/users')
        response.raise_for_status()  # Raise an exception for bad status codes
        users = response.json()
        return len(users)
    except requests.RequestException as e:
        print(f"Error fetching users: {e}")
        return 0

def get_total_products():
    """
    Get the total count of products from the backend API
    Returns:
        int: Total number of products
    """
    try:
        response = requests.get('https://backend-879168005744.us-west1.run.app/products')
        response.raise_for_status()  # Raise an exception for bad status codes
        products = response.json()
        return len(products)
    except requests.RequestException as e:
        print(f"Error fetching products: {e}")
        return 0

# Example usage
if __name__ == "__main__":
    total_users = get_total_users()
    total_products = get_total_products()
    
    print(f"Total Users: {total_users}")
    print(f"Total Products: {total_products}")

##### Results
Total Users: 10
Total Products: 207
                
                </code></pre>
            </div>

            <div class="mb-8">
                <h3 class="text-lg font-medium text-gray-700 mb-2">PYTHON: Example of Image Generation</h3>
                <pre class="max-h-[30rem] overflow-y-auto"><code class="language-python" id="python_example">
"""
Tutorial: Using Google's Vertex AI Imagen for Image Generation and Editing
This script demonstrates how to use Google's Vertex AI Imagen service to generate
and edit images using AI.
"""

# Import required libraries
import requests
from google.oauth2 import service_account
from google import genai
from google.genai import types
from google.genai.types import (
    Image,
    RawReferenceImage,
    MaskReferenceImage
)

def setup_vertex_client():
    """Initialize and return a Vertex AI client with proper credentials."""
    credentials = service_account.Credentials.from_service_account_file(
        './key.json',
        scopes=['https://www.googleapis.com/auth/cloud-platform']
    )
    
    return genai.Client(
        vertexai=True,
        project='bake-off-hosting',
        location='us-central1',
        http_options=types.HttpOptions(api_version='v1'),
        credentials=credentials
    )

def get_image_from_url(image_url):
    """Fetch an image from a URL and return its content."""
    response = requests.get(image_url)
    if response.status_code == 200:
        return response.content
    raise Exception(f"Failed to fetch image from URL: {image_url}")

def generate_image(client, prompt, output_path):
    """Generate a new image using Imagen."""
    image = client.models.generate_images(
        model="imagen-4.0-ultra-generate-exp-05-20",
        prompt=prompt
    )
    
    image.generated_images[0].image.save(output_path)
    print(f"Generated image saved to {output_path}")

def edit_image(client, prompt, reference_image, output_path):
    """Edit an existing image using Imagen's editing capabilities."""
    # Create reference images for editing
    raw_ref = RawReferenceImage(
        reference_id=1,
        reference_image=reference_image
    )
    
    mask_ref = MaskReferenceImage(
        reference_id=2,
        config=types.MaskReferenceConfig(
            mask_mode='MASK_MODE_BACKGROUND',
            mask_dilation=0
        )
    )
    
    # Perform the image edit
    response = client.models.edit_image(
        model='imagen-3.0-capability-001',
        prompt=prompt,
        reference_images=[raw_ref, mask_ref],
        config=types.EditImageConfig(
            edit_mode='EDIT_MODE_INPAINT_INSERTION',
            number_of_images=1,
            include_rai_reason=True,
            output_mime_type='image/jpeg'
        )
    )
    
    response.generated_images[0].image.save(output_path)
    print(f"Edited image saved to {output_path}")

def main():
    # Initialize the client
    client = setup_vertex_client()
    
    # Example 1: Generate a new image
    generate_image(
        client,
        "A dog reading a newspaper",
        "./images/imagen4-dog_reading_newspaper.png"
    )
    
    # Example 2: Edit an existing image pulling in an image from the API
    image_url = "https://backend-879168005744.us-west1.run.app/images/users/user_1_Marcus-W._V1.jpg"
    image_bytes = get_image_from_url(image_url)
    reference_image = Image(image_bytes=image_bytes)
    
    edit_image(
        client,
        "Add a big Big city, Sunlight and clear sky",
        reference_image,
        "./images/imagen3-edit-existing-image.png"
    )
    
    # Example 3: Edit another image using the display api
    response = requests.get("https://backend-879168005744.us-west1.run.app/users/4/display")
    api_image = Image(image_bytes=response.json()["image"].split(",")[1])
    
    edit_image(
        client,
        "A stunning boat in the ocean",
        api_image,
        "./images/imagen-3-existing-image-display.png"
    )

if __name__ == "__main__":
    main()
                                        
                </code></pre>
            </div>

            <script>
                const origin = window.location.origin;
                let output_product = `// Fetch and display a product
const productId = "2";
const response = await fetch(\`${origin}/products/\${productId}/display\`);
const product = await response.json();

// Example response:
{
  "id": "2",
  "image": "data:image/jpeg;base64,...",
  "description": "beautiful typography that says 'ADK' on it on a any color t-shirt - Variant 3",
  "type": "T-Shirt",
  "color": "Any Color",
  "graphic": "beautiful typography that says 'ADK' on it",
  "variant": "3",
  "stock": 16,
  "price": "$26.62",
  "created_at": "2025-06-09T12:57:19.717345",
  "stock_status": "In Stock"
}`;

let output_user = `// Fetch and display a user profile
const userId = "user_1";
const response = await fetch(\`${origin}/users/\${userId}/display\`);
const user = await response.json();

// Example response:
{
  "id": "user_1",
  "image": "data:image/jpeg;base64,...",
  "name": "Marcus W.",
  "description": "black male model with an curly hair",
  "style_preferences": [
    "sweater",
    "scarf",
    "long sleeve"
  ],
  "purchase_history": [
    "118",
    "111",
    "48",
    "193",
    "144",
    "81",
    "14",
    "120"
  ],
  "cart_status": {
    "items": [
      {
        "product_id": "166",
        "quantity": 2,
        "added_at": "2025-06-02T16:53:32.024311"
      },
      {
        "product_id": "137",
        "quantity": 2,
        "added_at": "2025-06-08T16:53:32.024334"
      }
    ],
    "total_items": 2,
    "total_price": 189.24
  },
  "created_at": "2025-06-09T16:53:32.024343"
}
}`;
                document.getElementById("product_example").textContent = output_product;
                document.getElementById("user_example").textContent = output_user;
            </script>
        </section>
    </div>
</body>
</html>